import{j as i}from"./jsx-runtime-beaa2906.js";import{R as h,T as v,N as A,V as m,Q as T,i as y,W as L,X as w,x as G,y as M,G as f,Y as P,Z as _,_ as g,$ as b,a0 as C,a1 as j,a2 as O,a3 as N,o as I,a4 as V,E as R,c as Y,e as q,f as Q,g as U,h as H,m as $,j as B,k as K}from"./ErrorBoundaryFallback-d3af9f8f.js";import{r as x}from"./index-f46741a2.js";import{g as F,f as J,u as X,G as W,i as Z,a as D,C as z,d as ee,e as re}from"./buildASTSchema-d6049cd3.js";function te(p){return({value:r,state:e,rules:a,path:l,key:d})=>{if(typeof d=="symbol")return{done:!0};if(r==null)return{done:!0};if(!a)return h(l)?{done:!0}:{value:r,state:e};if(!(a!=null&&a.kind)||!v.includes(a.kind))return h(l)?{done:!0}:{value:r,state:e};const u="#"+A(l),{parent:s,container:o}=e,{kind:c}=a;let t={value:r,node:{}};switch(c){case m.query:case m.mutation:case m.subscription:{t=p.createGraphSchemaNode({id:u,kind:c,key:d,value:r,parent:s,container:o,newDataLevel:!1,isCycle:!1});break}case m.schema:{const{description:S}=r,k={value:{description:S},parent:s,container:o,meta:{...T(r)?{brokenRef:r.$ref}:{},_fragment:r},newDataLevel:!1};t.node=p.createNode(u,c,d,!1,k);break}}s==null||s.addChild(t.node);let n=e.alreadyConvertedMappingStack;y(r)&&"typeDef"in r?L.set(r.typeDef,t.node):(n=new Map(e.alreadyConvertedMappingStack),n.set(r,t.node));const E=t.node.type===w.simple?{parent:t.node,alreadyConvertedMappingStack:n}:{parent:s,container:t.node,alreadyConvertedMappingStack:n};return{value:t.value,state:E}}}class ne extends G{createNodeMeta(r){const{value:e}=r;return M(e)==="simple"?{...f(e,O),...P(e),_fragment:e}:{_fragment:e}}createNodeValue(r){var d,u,s,o,c;const{value:e}=r;if(e==null)return null;if(!y(e))return e;if(_(e)){const t=["title","description"];return{...f(e.definition,t),...e.meta?{meta:e.meta}:{}}}let a;if(g(e)?a=e:y(e.typeDef)&&(g(e.typeDef)||b(e.typeDef))&&(a=e.typeDef),a){const t=a!==e;let n;return((d=r.parent)==null?void 0:d.kind)===C.args&&((s=(u=r.parent)==null?void 0:u.parent)==null?void 0:s.kind)===C.directiveUsage&&(n=(c=(o=r.parent.parent.value())==null?void 0:o.meta)==null?void 0:c[r.key]),{...t?f(e,N):{},...f(a,N),type:a.type.kind,...j(e.typeDef),...n!==void 0?{value:n}:{}}}return f(e,["title","description","directives"])}createGraphSchemaNode(r){return this.createJsonSchemaNode(r)}}const ae=p=>{const r=new ne(p);if(!y(p))return r;const e={parent:null,alreadyConvertedMappingStack:new Map};return I(p,[V(r),te(r),J(r)],{state:e,rules:F}),r},oe=p=>i.jsx(R,{fallback:i.jsx(Y,{componentName:"GraphQL Operation Viewer"}),children:i.jsx(se,{...p})}),se=p=>{X();const{source:r,operationPath:e,expandedDepth:a=B,displayMode:l=K}=p;console.log("source",r);const d=x.useMemo(()=>ae(r),[r]);console.log("tree",d);const s=x.useMemo(()=>new W(d,e,a),[a,e,d]).root;return s?i.jsx(q.Provider,{value:l,children:i.jsx(Q.Provider,{value:0,children:i.jsx("div",{style:{marginLeft:0},children:s.children.map((o,c)=>{const t=`root-children-${c}`;if(Z(o)){const n=o.meta;return U(o.node)?e||o.first?i.jsx(D,{state:o,$nodeChange:n==null?void 0:n.$nodeChange},t):null:H(o.node)&&o.first?i.jsxs("div",{children:[i.jsx(z,{layoutMode:$}),i.jsx(D,{state:o,$nodeChange:n==null?void 0:n.$nodeChange})]},t):i.jsx(D,{state:o,$nodeChange:n==null?void 0:n.$nodeChange},t)}return ee(o)?i.jsx(re,{state:o,onGlobalSelectNestedNode:()=>null},t):null})})})}):null};oe.__docgenInfo={description:"",methods:[],displayName:"GraphQLOperationViewer",props:{source:{required:!0,tsType:{name:"unknown"},description:""},operationPath:{required:!1,tsType:{name:"string"},description:""},expandedDepth:{required:!1,tsType:{name:"number"},description:""},displayMode:{required:!1,tsType:{name:"union",raw:`| typeof SIMPLE_DISPLAY_MODE
| typeof DETAILED_DISPLAY_MODE`,elements:[{name:"SIMPLE_DISPLAY_MODE"},{name:"DETAILED_DISPLAY_MODE"}]},description:""}}};export{oe as G};
