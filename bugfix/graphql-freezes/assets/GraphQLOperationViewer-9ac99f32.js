import{j as a}from"./jsx-runtime-beaa2906.js";import{R as S,T,N as v,V as D,Q as w,i as h,W as A,X as L,x as M,y as G,G as y,Y as P,Z as _,_ as C,$ as b,a0 as N,a1 as j,a2 as O,a3 as x,o as I,a4 as V,E as R,c as Y,e as q,f as Q,g as U,h as H,m as $,j as B,k as K}from"./ErrorBoundaryFallback-d3af9f8f.js";import{r as E}from"./index-f46741a2.js";import{g as F,f as J,u as X,G as W,i as Z,a as g,C as z,d as ee,e as te}from"./buildASTSchema-d6049cd3.js";function re(o){return({value:t,state:e,rules:n,path:f,key:l})=>{if(typeof l=="symbol")return{done:!0};if(t==null)return{done:!0};if(!n)return S(f)?{done:!0}:{value:t,state:e};if(!(n!=null&&n.kind)||!T.includes(n.kind))return S(f)?{done:!0}:{value:t,state:e};const d="#"+v(f),{parent:s,container:u}=e,{kind:c}=n;let r={value:t,node:{}};switch(c){case D.query:case D.mutation:case D.subscription:{r=o.createGraphSchemaNode({id:d,kind:c,key:l,value:t,parent:s,container:u,newDataLevel:!1,isCycle:!1});break}case D.schema:{const{description:i}=t,k={value:{description:i},parent:s,container:u,meta:{...w(t)?{brokenRef:t.$ref}:{},_fragment:t},newDataLevel:!1};r.node=o.createNode(d,c,l,!1,k);break}}s==null||s.addChild(r.node);let p=e.alreadyConvertedMappingStack;h(t)&&"typeDef"in t?A.set(t.typeDef,r.node):(p=new Map(e.alreadyConvertedMappingStack),p.set(t,r.node));const m=r.node.type===L.simple?{parent:r.node,alreadyConvertedMappingStack:p}:{parent:s,container:r.node,alreadyConvertedMappingStack:p};return{value:r.value,state:m}}}class ne extends M{createNodeMeta(t){const{value:e}=t;return G(e)==="simple"?{...y(e,O),...P(e),_fragment:e}:{_fragment:e}}createNodeValue(t){var l,d,s,u,c;const{value:e}=t;if(e==null)return null;if(!h(e))return e;if(_(e)){const r=["title","description"];return{...y(e.definition,r),...e.meta?{meta:e.meta}:{}}}let n;if(C(e)?n=e:h(e.typeDef)&&(C(e.typeDef)||b(e.typeDef))&&(n=e.typeDef),n){const r=n!==e;let p;return((l=t.parent)==null?void 0:l.kind)===N.args&&((s=(d=t.parent)==null?void 0:d.parent)==null?void 0:s.kind)===N.directiveUsage&&(p=(c=(u=t.parent.parent.value())==null?void 0:u.meta)==null?void 0:c[t.key]),{...r?y(e,x):{},...y(n,x),type:n.type.kind,...j(e.typeDef),...p!==void 0?{value:p}:{}}}return y(e,["title","description","directives"])}createGraphSchemaNode(t){return this.createJsonSchemaNode(t)}}const ae=o=>{const t=new ne(o);if(!h(o))return t;const e={parent:null,alreadyConvertedMappingStack:new Map};return I(o,[V(t),re(t),J(t)],{state:e,rules:F}),t},oe=o=>a.jsx(R,{fallback:a.jsx(Y,{componentName:"GraphQL Operation Viewer"}),children:a.jsx(se,{...o})}),se=o=>{X();const{source:t,operationPath:e,expandedDepth:n=B,displayMode:f=K}=o,l=new Date().toISOString(),d=E.useMemo(()=>ae(t),[t]),s=new Date().toISOString();console.log("start",l),console.log("end",s);const u=E.useMemo(()=>new W(d,e,n),[n,e,d]);console.debug("Tree Model:",d);const c=u.root;return c?a.jsx(q.Provider,{value:f,children:a.jsx(Q.Provider,{value:0,children:a.jsx("div",{style:{marginLeft:0},children:c.children.map((r,p)=>{const m=`root-children-${p}`;if(Z(r)){const i=r.meta;return U(r.node)?e||r.first?a.jsx(g,{state:r,$nodeChange:i==null?void 0:i.$nodeChange},m):null:H(r.node)&&r.first?a.jsxs("div",{children:[a.jsx(z,{layoutMode:$}),a.jsx(g,{state:r,$nodeChange:i==null?void 0:i.$nodeChange})]},m):a.jsx(g,{state:r,$nodeChange:i==null?void 0:i.$nodeChange},m)}return ee(r)?a.jsx(te,{state:r,onGlobalSelectNestedNode:()=>null},m):null})})})}):null};oe.__docgenInfo={description:"",methods:[],displayName:"GraphQLOperationViewer",props:{source:{required:!0,tsType:{name:"unknown"},description:""},operationPath:{required:!1,tsType:{name:"string"},description:""},expandedDepth:{required:!1,tsType:{name:"number"},description:""},displayMode:{required:!1,tsType:{name:"union",raw:`| typeof SIMPLE_DISPLAY_MODE
| typeof DETAILED_DISPLAY_MODE`,elements:[{name:"SIMPLE_DISPLAY_MODE"},{name:"DETAILED_DISPLAY_MODE"}]},description:""}}};export{oe as G};
