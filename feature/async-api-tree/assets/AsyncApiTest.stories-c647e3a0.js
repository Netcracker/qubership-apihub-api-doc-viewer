var X=Object.defineProperty;var W=(s,e,n)=>e in s?X(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var E=(s,e,n)=>(W(s,typeof e!="symbol"?e+"":e,n),n);import{j as c}from"./_commonjs-dynamic-modules-6308e768.js";import{T as z,V as Q,W as Z,X as ee,Y as te,Z as ne,_ as se,$ as re,a0 as oe,a1 as ae,a2 as ie,a3 as ce,a4 as de,a5 as le,a6 as ue,a7 as pe,a8 as Ee,a9 as _e,aa as Ne,ab as Ae,ac as me,ad as ye,ae as Se,af as Oe,ag as fe,ah as Te,ai as Pe,aj as he,ak as Re,al as Me,am as Ce,an as ge,ao as Ie,ap as xe,aq as Le,ar as Ye,as as De,at as ve,au as we,av as He,aw as be,ax as Je,ay as B,p as ke,B as v,A as Ve,az as je,aA as Be,M as D,I as Ue,R as Fe,P as qe,O as w,S as U,E as Ke,e as Ge,g as $e,L as Xe,o as We,h as ze,m as Qe}from"./constants-39319f53.js";import{r as y}from"./index-f46741a2.js";import{e as Ze}from"./preprocess-cc947758.js";const O={SIMPLE:"simple",COMPLEX:"complex"};class R{constructor(e="#",n="",t,o,r){E(this,"type");E(this,"parent");E(this,"container");E(this,"newDataLevel");E(this,"_value");E(this,"_meta");E(this,"_childrenNodes",[]);E(this,"_nestedNodes",[]);this.id=e,this.key=n,this.kind=t,this.isCycle=o;const{type:a=O.SIMPLE,value:i=null,parent:l=null,container:u=null,newDataLevel:N=!0,meta:p}=r;this.type=a,this.parent=l,this.container=u,this.newDataLevel=N,this._value=i,this._meta=p}createCycledClone(e,n,t){const o=new R(e,n,this.kind,!0,{type:this.type,parent:t,container:null,newDataLevel:this.newDataLevel,value:this._value!==null?{...this._value}:null,meta:{...this._meta}});return o.setChildrenNodes(this._childrenNodes),o.setNestedNodes(this._nestedNodes),o}value(e){return e?null:this._value}meta(){return this._meta}childrenNodes(e){return e?[]:this._childrenNodes}setChildrenNodes(e){this._childrenNodes.length=0,this._childrenNodes.push(...e)}nestedNodes(){return this._nestedNodes}setNestedNodes(e){this._nestedNodes.length=0,this._nestedNodes.push(...e)}findNestedNode(e,n=!1){if(!e&&this._nestedNodes.length)return this._nestedNodes[0];for(const t of this._nestedNodes){if(t.id===e)return t;if(n&&t instanceof M){const o=t.findNestedNode(e,n);if(o)return o}}return null}addChildNode(e){this._childrenNodes.push(e)}addNestedNode(e){this._nestedNodes.push(e)}}class M extends R{constructor(n="#",t="",o,r,a){super(n,t,o,r,a);E(this,"type");this.id=n,this.key=t,this.kind=o,this.type=a.type}createCycledClone(n,t,o){const r=new M(n,t,this.kind,!0,{type:this.type,parent:o,container:null,newDataLevel:this.newDataLevel,value:this._value!==null?{...this._value}:null,meta:{...this._meta}});return r.setChildrenNodes(this._childrenNodes),r.setNestedNodes(this._nestedNodes),r}value(n){const t=this.findNestedNode(n,!0);return(t==null?void 0:t.value())??null}children(n){const t=this.findNestedNode(n,!0);return(t==null?void 0:t.childrenNodes())??[]}}class et{constructor(){E(this,"nodes",new Map)}get root(){return this.nodes.get("#")??null}createSimpleNode(e,n,t,o,r){const a=new R(e,n,t,o,r);return this.nodes.set(e,a),a}createComplexNode(e,n,t,o,r){const a=new M(e,n,t,o,r);return this.nodes.set(e,a),a}createCycledClone(e,n,t,o){const r=e.createCycledClone(n,t,o);return this.nodes.set(n,r),r}}class tt extends et{constructor(){super()}}const d={ROOT:"root",OPERATION:"operation",BINDINGS:"bindings",BINDING:"binding",JSO_PROPERTY:"jsoProperty",CHANNEL:"channel",MESSAGES:"messages",MESSAGE:"message"},nt=Object.values(d),st={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",OBJECT:"object",ARRAY:"array",JSON_SCHEMA:"jsonSchema"},rt=Object.values(st);function A(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function C(s){return Array.isArray(s)}function ot(s){return typeof s=="string"}class at{constructor(){E(this,"tree",null)}pick(e,n){if(!A(e))return null;const t={};for(const o of n){const r=String(o);if(!(r in e))continue;const a=e[r];Array.isArray(a)?t[r]=[...a]:A(a)?t[r]={...a}:t[r]=a}return this.isPartialOf(t,n)?t:null}isPartialOf(e,n){return Object.keys(e).every(t=>n.includes(t))}}const F="UNKNOWN ADDRESS (NULL)",it=(s,e)=>!A(e)||C(e)||e.address?e:{...e,address:F},ct=(s,e)=>!A(e)||C(e)?e:{...e,protocol:typeof s=="symbol"?s.toString():`${s}`},x=(s,e)=>({title:typeof s=="symbol"?s.toString():`${s}`,value:e,valueType:dt(e)});function dt(s){return typeof s=="string"?"string":typeof s=="number"?"number":typeof s=="boolean"?"boolean":typeof s=="object"&&s!==null?Array.isArray(s)?"array":lt(s)?"jsonSchema":ut(s)?"multiSchema":"object":"unknown"}function lt(s){if(typeof s!="object"||s===null)return!1;const e="type"in s&&typeof s.type=="string"&&z.some(t=>t===s.type),n=new Set([Q,Z,ee,te,ne,se,re,oe,ae,ie,ce,de,le,ue,pe,Ee,_e,Ne,Ae,me,ye,Se,Oe,fe,Te,Pe,he,Re,Me,Ce,ge,Ie,xe,Le,Ye,De,ve,we,He,be,Je,B]);return e&&Object.keys(s).every(t=>n.has(t))}function ut(s){return typeof s!="object"||s===null?!1:!!("schemaFormat"in s&&typeof s.schemaFormat=="string"&&"schema"in s&&A(s.schema))}const pt=(s,e)=>!A(e)||C(e)?e:A(e.channel)?{...e,address:e.channel.address?e.channel.address:F}:e,Et=(s,e)=>{if(!A(e)||C(e))return e;const{name:n,...t}=e;return{...t,...n?{internalTitle:n}:{}}};function h(s=d.ROOT){return{"/operations":{"/*":()=>({...h(d.OPERATION),transformers:[pt]})},"/channel":()=>({...h(d.CHANNEL),"/messages":{kind:void 0},transformers:[it]}),"/bindings":{"/*":{"/protocol":{kind:void 0},"/*":()=>({kind:d.JSO_PROPERTY,transformers:[x]}),kind:d.BINDING,transformers:[ct]},kind:d.BINDINGS,complex:!0},"/messages":{"/*":()=>({...h(d.MESSAGE),transformers:[Et]}),kind:d.MESSAGES,complex:!0},"/headers":{kind:d.JSO_PROPERTY,transformers:[x]},"/payload":{kind:d.JSO_PROPERTY,transformers:[x]},kind:s}}const _=class _ extends at{constructor(n){super();E(this,"tree");this.source=n,this.tree=new tt}static getAsyncApiTreeNodeValueProps(n){switch(n){case d.ROOT:return _.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS;case d.OPERATION:return[..._.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"action","address"];case d.BINDING:return[..._.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"protocol"];case d.JSO_PROPERTY:return[..._.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"value","valueType"];case d.CHANNEL:return _.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS;case d.MESSAGE:return[..._.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"internalTitle"];default:return[]}}build(){if(!A(this.source))return this.tree;const n={parent:null,container:null,alreadyConvertedValuesCache:new Map},t=h();return ke(this.source,[this.instantiateHookPreventingTreeBuildingProcessFromInfiniteLoop(),this.instantiateHookUnifyingValue(this.source),this.instantiateHookCreatingAsyncApiTreeNodes()],{state:n,rules:t}),this.tree}instantiateHookPreventingTreeBuildingProcessFromInfiniteLoop(){return({value:n,state:t,key:o,path:r})=>{if(typeof o=="symbol")return;const{alreadyConvertedValuesCache:a,parent:i,container:l}=t,u=a.get(n);if(!u||!this.isAsyncApiSimpleTreeNode(u)&&!this.isAsyncApiComplexTreeNode(u))return{value:n};if(!i||!this.isAsyncApiSimpleTreeNode(i))return{value:n};const N="#"+v(r),p=this.tree.createCycledClone(u,N,o,i);return l&&l.addNestedNode(p),i&&i.addChildNode(p),{done:!0}}}instantiateHookUnifyingValue(n){return({key:t,value:o,path:r,state:a,rules:i})=>!i||!Array.isArray(i.transformers)?void 0:{value:(i.transformers??[]).reduce((N,p)=>p(t,N,n,r,a),o)}}instantiateHookCreatingAsyncApiTreeNodes(){return({key:n,value:t,path:o,rules:r,state:a})=>{if(!r)return{done:!0};if(typeof n=="symbol")return{done:!0};if(t==null||!A(t)&&!Ve(t))return{done:!0};if(!r.kind||!nt.includes(r.kind))return;const{parent:i,container:l}=a,u="#"+v(o),{kind:N,complex:p=!1}=r,g=l?{value:Array.isArray(t)?null:t,newDataLevel:!0,container:l,parent:l.parent}:{value:Array.isArray(t)?null:t,newDataLevel:!0,container:null,parent:i},m=this.createNodeFromRaw(u,n,N,p,g);if(!m)return;l?l.addNestedNode(m):i&&i.addChildNode(m);const S=new Map(a.alreadyConvertedValuesCache);S.set(t,m);let I;return this.isAsyncApiSimpleTreeNode(m)&&(I={parent:m,container:null,alreadyConvertedValuesCache:S}),this.isAsyncApiComplexTreeNode(m)&&(I={parent:i,container:m,alreadyConvertedValuesCache:S}),{value:t,state:I}}}createNodeFromRaw(n,t,o,r,a){const{parent:i,container:l,newDataLevel:u}=a;if(r){const m=this.createNodeMeta(t,a),S={type:O.COMPLEX,parent:i&&this.isAsyncApiSimpleTreeNode(i)?i:null,container:l&&this.isAsyncApiComplexTreeNode(l)?l:null,value:null,meta:m,newDataLevel:u};return this.tree.createComplexNode(n,t,o,!1,S)}const N=this.createNodeValue(t,o,{...a,parent:i,container:l}),p=this.createNodeMeta(t,a),g={type:O.SIMPLE,parent:i&&this.isAsyncApiSimpleTreeNode(i)?i:null,container:l&&this.isAsyncApiComplexTreeNode(l)?l:null,value:N,meta:p,newDataLevel:u};return this.tree.createSimpleNode(n,t,o,!1,g)}createNodeMeta(n,t){const{value:o,parent:r=null}=t;return{...this.isValueWithBrokenRef(o)?{brokenRef:`${o.$ref}`}:{},_fragment:o}}createNodeValue(n,t,o){const{value:r}=o;if(r==null||!A(r))return null;switch(t){case d.OPERATION:return this.pick(r,_.getAsyncApiTreeNodeValueProps(t));case d.BINDING:return this.pick(r,_.getAsyncApiTreeNodeValueProps(t));case d.JSO_PROPERTY:return this.pick(r,_.getAsyncApiTreeNodeValueProps(t));case d.CHANNEL:return this.pick(r,_.getAsyncApiTreeNodeValueProps(t));case d.MESSAGE:return this.pick(r,_.getAsyncApiTreeNodeValueProps(t));default:return null}}isAsyncApiNodeType(n){return!n||!ot(n)?!1:rt.some(t=>t===n)}isAsyncApiSimpleTreeNode(n){return n.type===O.SIMPLE}isAsyncApiComplexTreeNode(n){return!this.isAsyncApiSimpleTreeNode(n)}isValueWithBrokenRef(n){return A(n)&&B in n}getNodeComplexityType(n){return O.SIMPLE}};E(_,"ASYNC_API_TREE_NODE_META_PROPS",[]),E(_,"ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS",["title","description","summary"]);let Y=_;const q=s=>{const{expandable:e,expanded:n,onClickExpander:t,level:o}=s,r=o>0;return!e&&!r?null:c.jsxs("div",{className:`flex flex-row items-center justify-center ${r?"gap-3":""}`,children:[r&&c.jsx(je,{short:e}),e&&n!==void 0&&t&&c.jsx(Be,{onToggle:t,expanded:n})]})};q.__docgenInfo={description:"",methods:[],displayName:"Expander",props:{expandable:{required:!0,tsType:{name:"boolean"},description:""},expanded:{required:!1,tsType:{name:"boolean"},description:""},onClickExpander:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},level:{required:!0,tsType:{name:"number"},description:""}}};const f={h1:"h1",h2:"h2",h3:"h3",body:"body"},K=y.memo(s=>{const e=D();return e===Ue?c.jsxs("div",{style:{fontSize:12,marginTop:4,marginBottom:4},children:["This layout mode (",e,") is not supported."]}):c.jsx(mt,{...s})}),L=y.memo(s=>{const{value:e,diff:n,expandable:t,expanded:o,onClickExpander:r,level:a,variant:i,layoutSide:l}=s,p=D()===U?"w-1/2":"w-full";return c.jsxs("div",{className:`flex flex-row gap-5 ${p}`,children:[c.jsx(Fe,{level:a}),c.jsx(q,{expandable:t,expanded:o,onClickExpander:r,level:a}),c.jsx(Nt,{...s})]})}),_t={[f.h1]:"text-xl",[f.h2]:"text-lg",[f.h3]:"text-base",[f.body]:"text-xs"},Nt=y.memo(s=>{const{value:e,diff:n,variant:t}=s,o=y.useMemo(()=>At(e),[n,e]);return c.jsx("div",{className:`${_t[t]}`,children:o})});function At(s,e){return s}const mt=y.memo(s=>D()===U?c.jsxs("div",{className:"flex flex-row relative",children:[c.jsx(L,{...s,layoutSide:qe}),c.jsx(L,{...s,layoutSide:w})]}):c.jsx("div",{className:"flex flex-row relative",children:c.jsx(L,{...s,layoutSide:w})}));K.__docgenInfo={description:"",methods:[],displayName:"TitleRow",props:{value:{required:!1,tsType:{name:"string"},description:""},diff:{required:!1,tsType:{name:"Diff"},description:""},expandable:{required:!0,tsType:{name:"boolean"},description:""},expanded:{required:!1,tsType:{name:"boolean"},description:""},onClickExpander:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},level:{required:!0,tsType:{name:"number"},description:""},variant:{required:!0,tsType:{name:"TitleVariant"},description:""}}};const G=s=>c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx(K,{value:"Operation Title",expandable:!1,level:0,variant:"h1"}),c.jsx("div",{children:"List of operation children"})]});G.__docgenInfo={description:"",methods:[],displayName:"OperationNodeViewer",props:{node:{required:!0,tsType:{name:"ITreeNode",elements:[{name:"union",raw:"AsyncApiTreeNodeValue<AsyncApiTreeNodeKind> | null",elements:[{name:"unknown"},{name:"null"}]},{name:"AsyncApiTreeNodeKinds[union]",raw:"typeof AsyncApiTreeNodeKinds[keyof typeof AsyncApiTreeNodeKinds]"},{name:"Partial",elements:[{name:"signature",type:"object",raw:`{
  readonly brokenRef?: string
  readonly _fragment: unknown
}`,signature:{properties:[{key:"brokenRef",value:{name:"string",required:!1}},{key:"_fragment",value:{name:"unknown",required:!0}}]}}],raw:`Partial<{
  readonly brokenRef?: string
  readonly _fragment: unknown
}>`}],raw:"ITreeNode<AsyncApiTreeNodeValue<AsyncApiTreeNodeKind> | null, AsyncApiTreeNodeKind, AsyncApiNodeMeta>"},description:""}}};const $=y.memo(s=>c.jsx(Ke,{fallback:c.jsx(Ge,{componentName:"Async API Operation Viewer"}),children:c.jsx(yt,{...s})})),yt=y.memo(s=>{const{source:e,operationType:n,operationName:t,displayMode:o=Qe}=s,a=new Y(e).build();console.debug("[AsyncAPI] Tree:",a);const i=a.root;if(!i)return null;const u=i.childrenNodes().find(N=>{const p=N.value();return N.key===t&&N.kind===d.OPERATION&&St(p)&&p.action===n});return u?c.jsx($e.Provider,{value:o,children:c.jsxs(Xe.Provider,{value:We,children:[" ",c.jsx(ze.Provider,{value:0,children:c.jsx(G,{node:u})})]})}):null});function St(s){return s!==null&&"action"in s&&typeof s.action=="string"&&(s.action==="send"||s.action==="receive")}$.__docgenInfo={description:"",methods:[],displayName:"AsyncApiOperationViewer",props:{source:{required:!0,tsType:{name:"unknown"},description:""},operationType:{required:!1,tsType:{name:"string"},description:""},operationName:{required:!1,tsType:{name:"string"},description:""},displayMode:{required:!1,tsType:{name:"union",raw:`| typeof SIMPLE_DISPLAY_MODE
| typeof DETAILED_DISPLAY_MODE`,elements:[{name:"SIMPLE_DISPLAY_MODE"},{name:"DETAILED_DISPLAY_MODE"}]},description:""}}};const Mt={title:"Async Api Viewer",component:$,parameters:{},argTypes:{source:{control:"object"}},args:{source:{}}},T={args:{source:{}}},Ot={asyncapi:"3.0.0",info:{title:"example-event-service",version:"1.0.0","x-generator":"springwolf"},defaultContentType:"application/json",servers:{"kafka-main":{host:"kafka-host",protocol:"kafka"}},channels:{"customer-change-topic":{address:"customer-change-topic",description:"Channel for customer change notifications",messages:{BaseEventMessage:{$ref:"#/components/messages/BaseEventMessage"}},servers:[{$ref:"#/servers/kafka-main"}],bindings:{}}},components:{schemas:{HeadersExample:{title:"HeadersExample",type:"object",properties:{"X-Idempotency-Key":{type:"string"}},examples:[{"X-Idempotency-Key":"string"}]},BaseEvent:{title:"BaseEvent",type:"object",properties:{currentInstance:{type:"object",description:"New data state"},currentModelVersion:{type:"integer",description:"Model Version",format:"int32"},previousInstance:{type:"object",description:"Previous data state"},resourceAction:{type:"string",description:"Resource Action"},resourceType:{type:"string",description:"Resource Type"}},description:"Base event to describe Customer's data changes",examples:[{currentInstance:{},currentModelVersion:0,previousInstance:{},resourceAction:"string",resourceType:"string"}],required:["currentInstance","currentModelVersion","previousInstance","resourceAction","resourceType"]}},messages:{BaseEventMessage:{headers:{$ref:"#/components/schemas/HeadersExample"},payload:{schemaFormat:"application/vnd.aai.asyncapi+json;version=3.0.0",schema:{$ref:"#/components/schemas/BaseEvent"}},name:"BaseEventMessage",title:"BaseEvent",bindings:{kafka:{bindingVersion:"0.5.0"}}}}},operations:{"customer-change-topic_send_BaseEvent":{action:"send",channel:{$ref:"#/channels/customer-change-topic"},title:"Customer change topic send",description:"Send events about Customer's data changes",bindings:{kafka:{bindingVersion:"0.5.0"}},messages:[{$ref:"#/channels/customer-change-topic/messages/BaseEventMessage"}]}}},P={args:{source:Ze({source:Ot}),operationName:"customer-change-topic_send_BaseEvent",operationType:"send"}};var H,b,J;T.parameters={...T.parameters,docs:{...(H=T.parameters)==null?void 0:H.docs,source:{originalSource:`{
  args: {
    source: {}
  }
}`,...(J=(b=T.parameters)==null?void 0:b.docs)==null?void 0:J.source}}};var k,V,j;P.parameters={...P.parameters,docs:{...(k=P.parameters)==null?void 0:k.docs,source:{originalSource:`{
  args: {
    source: prepareAsyncApiDocument({
      source: KAFKA_E2E_SOURCE
    }),
    operationName: 'customer-change-topic_send_BaseEvent',
    operationType: 'send'
  }
}`,...(j=(V=P.parameters)==null?void 0:V.docs)==null?void 0:j.source}}};const Ct=["Test","KafkaE2E"];export{P as KafkaE2E,T as Test,Ct as __namedExportsOrder,Mt as default};
