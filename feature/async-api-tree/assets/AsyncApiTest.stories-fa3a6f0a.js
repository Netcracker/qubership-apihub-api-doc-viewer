var U=Object.defineProperty;var j=(r,e,s)=>e in r?U(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var l=(r,e,s)=>(j(r,typeof e!="symbol"?e+"":e,s),s);import{j as h}from"./_commonjs-dynamic-modules-6308e768.js";import{r as k}from"./index-f46741a2.js";import{J as v,A as F,B as G,F as K,G as X,H as $,I as W,K as q,L as Q,M as Z,N as z,O as ee,P as te,Q as se,R as re,S as ne,T as oe,V as ae,W as ie,X as ce,Y as de,Z as le,_ as Ee,$ as _e,a0 as pe,a1 as ue,a2 as Ne,a3 as Ae,a4 as Se,a5 as Oe,a6 as Pe,a7 as Re,a8 as he,a9 as me,aa as Te,ab as ye,ac as fe,ad as Me,ae as Ce,af as ge,ag as Ie,ah as Ye,ai as w,g as He,u as Y,t as Le,E as De,e as Je}from"./constants-2b09506c.js";import{e as Ve}from"./preprocess-9ed914ff.js";const O={SIMPLE:"simple",COMPLEX:"complex"};class T{constructor(e="#",s="",t,o,n){l(this,"type");l(this,"parent");l(this,"container");l(this,"newDataLevel");l(this,"_value");l(this,"_meta");l(this,"_childrenNodes",[]);l(this,"_nestedNodes",[]);this.id=e,this.key=s,this.kind=t,this.isCycle=o;const{type:a=O.SIMPLE,value:i=null,parent:d=null,container:_=null,newDataLevel:A=!0,meta:u}=n;this.type=a,this.parent=d,this.container=_,this.newDataLevel=A,this._value=i,this._meta=u}createCycledClone(e,s,t){const o=new T(e,s,this.kind,!0,{type:this.type,parent:t,container:null,newDataLevel:this.newDataLevel,value:this._value!==null?{...this._value}:null,meta:{...this._meta}});return o.setChildrenNodes(this._childrenNodes),o.setNestedNodes(this._nestedNodes),o}value(e){return e?null:this._value}meta(){return this._meta}childrenNodes(e){return e?[]:this._childrenNodes}setChildrenNodes(e){this._childrenNodes.length=0,this._childrenNodes.push(...e)}nestedNodes(){return this._nestedNodes}setNestedNodes(e){this._nestedNodes.length=0,this._nestedNodes.push(...e)}findNestedNode(e,s=!1){if(!e&&this._nestedNodes.length)return this._nestedNodes[0];for(const t of this._nestedNodes){if(t.id===e)return t;if(s&&t instanceof y){const o=t.findNestedNode(e,s);if(o)return o}}return null}addChildNode(e){this._childrenNodes.push(e)}addNestedNode(e){this._nestedNodes.push(e)}}class y extends T{constructor(s="#",t="",o,n,a){super(s,t,o,n,a);l(this,"type");this.id=s,this.key=t,this.kind=o,this.type=a.type}createCycledClone(s,t,o){const n=new y(s,t,this.kind,!0,{type:this.type,parent:o,container:null,newDataLevel:this.newDataLevel,value:this._value!==null?{...this._value}:null,meta:{...this._meta}});return n.setChildrenNodes(this._childrenNodes),n.setNestedNodes(this._nestedNodes),n}value(s){const t=this.findNestedNode(s,!0);return(t==null?void 0:t.value())??null}children(s){const t=this.findNestedNode(s,!0);return(t==null?void 0:t.childrenNodes())??[]}}class be{constructor(){l(this,"nodes",new Map)}get root(){return this.nodes.get("#")??null}createSimpleNode(e,s,t,o,n){const a=new T(e,s,t,o,n);return this.nodes.set(e,a),a}createComplexNode(e,s,t,o,n){const a=new y(e,s,t,o,n);return this.nodes.set(e,a),a}createCycledClone(e,s,t,o){const n=e.createCycledClone(s,t,o);return this.nodes.set(s,n),n}}class ke extends be{constructor(){super()}}const c={ROOT:"root",OPERATION:"operation",BINDINGS:"bindings",BINDING:"binding",JSO_PROPERTY:"jsoProperty",CHANNEL:"channel",MESSAGES:"messages",MESSAGE:"message"},we=Object.values(c),xe={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",OBJECT:"object",ARRAY:"array",JSON_SCHEMA:"jsonSchema"},Be=Object.values(xe);function p(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function f(r){return Array.isArray(r)}function Ue(r){return typeof r=="string"}class je{constructor(){l(this,"tree",null)}pick(e,s){if(!p(e))return null;const t={};for(const o of s){const n=String(o);if(!(n in e))continue;const a=e[n];Array.isArray(a)?t[n]=[...a]:p(a)?t[n]={...a}:t[n]=a}return this.isPartialOf(t,s)?t:null}isPartialOf(e,s){return Object.keys(e).every(t=>s.includes(t))}}const x="UNKNOWN ADDRESS (NULL)",ve=(r,e)=>!p(e)||f(e)||e.address?e:{...e,address:x},Fe=(r,e)=>!p(e)||f(e)?e:{...e,protocol:typeof r=="symbol"?r.toString():`${r}`},g=(r,e)=>({title:typeof r=="symbol"?r.toString():`${r}`,value:e,valueType:Ge(e)});function Ge(r){return typeof r=="string"?"string":typeof r=="number"?"number":typeof r=="boolean"?"boolean":typeof r=="object"&&r!==null?Array.isArray(r)?"array":Ke(r)?"jsonSchema":Xe(r)?"multiSchema":"object":"unknown"}function Ke(r){if(typeof r!="object"||r===null)return!1;const e="type"in r&&typeof r.type=="string"&&v.some(t=>t===r.type),s=new Set([F,G,K,X,$,W,q,Q,Z,z,ee,te,se,re,ne,oe,ae,ie,ce,de,le,Ee,_e,pe,ue,Ne,Ae,Se,Oe,Pe,Re,he,me,Te,ye,fe,Me,Ce,ge,Ie,Ye,w]);return e&&Object.keys(r).every(t=>s.has(t))}function Xe(r){return typeof r!="object"||r===null?!1:!!("schemaFormat"in r&&typeof r.schemaFormat=="string"&&"schema"in r&&p(r.schema))}const $e=(r,e)=>!p(e)||f(e)?e:p(e.channel)?{...e,address:e.channel.address?e.channel.address:x}:e,We=(r,e)=>{if(!p(e)||f(e))return e;const{name:s,...t}=e;return{...t,...s?{internalTitle:s}:{}}};function m(r=c.ROOT){return{"/operations":{"/*":()=>({...m(c.OPERATION),transformers:[$e]})},"/channel":()=>({...m(c.CHANNEL),"/messages":{kind:void 0},transformers:[ve]}),"/bindings":{"/*":{"/protocol":{kind:void 0},"/*":()=>({kind:c.JSO_PROPERTY,transformers:[g]}),kind:c.BINDING,transformers:[Fe]},kind:c.BINDINGS,complex:!0},"/messages":{"/*":()=>({...m(c.MESSAGE),transformers:[We]}),kind:c.MESSAGES,complex:!0},"/headers":{kind:c.JSO_PROPERTY,transformers:[g]},"/payload":{kind:c.JSO_PROPERTY,transformers:[g]},kind:r}}const E=class E extends je{constructor(s){super();l(this,"tree");this.source=s,this.tree=new ke}static getAsyncApiTreeNodeValueProps(s){switch(s){case c.ROOT:return E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS;case c.OPERATION:return[...E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"action","address"];case c.BINDING:return[...E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"protocol"];case c.JSO_PROPERTY:return[...E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"value","valueType"];case c.CHANNEL:return E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS;case c.MESSAGE:return[...E.ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS,"internalTitle"];default:return[]}}build(){if(!p(this.source))return this.tree;const s={parent:null,container:null,alreadyConvertedValuesCache:new Map},t=m();return He(this.source,[this.instantiateHookPreventingTreeBuildingProcessFromInfiniteLoop(),this.instantiateHookUnifyingValue(this.source),this.instantiateHookCreatingAsyncApiTreeNodes()],{state:s,rules:t}),this.tree}instantiateHookPreventingTreeBuildingProcessFromInfiniteLoop(){return({value:s,state:t,key:o,path:n})=>{if(typeof o=="symbol")return;const{alreadyConvertedValuesCache:a,parent:i,container:d}=t,_=a.get(s);if(!_||!this.isAsyncApiSimpleTreeNode(_)&&!this.isAsyncApiComplexTreeNode(_))return{value:s};if(!i||!this.isAsyncApiSimpleTreeNode(i))return{value:s};const A="#"+Y(n),u=this.tree.createCycledClone(_,A,o,i);return d&&d.addNestedNode(u),i&&i.addChildNode(u),{done:!0}}}instantiateHookUnifyingValue(s){return({key:t,value:o,path:n,state:a,rules:i})=>!i||!Array.isArray(i.transformers)?void 0:{value:(i.transformers??[]).reduce((A,u)=>u(t,A,s,n,a),o)}}instantiateHookCreatingAsyncApiTreeNodes(){return({key:s,value:t,path:o,rules:n,state:a})=>{if(!n)return{done:!0};if(typeof s=="symbol")return{done:!0};if(t==null||!p(t)&&!Le(t))return{done:!0};if(!n.kind||!we.includes(n.kind))return;const{parent:i,container:d}=a,_="#"+Y(o),{kind:A,complex:u=!1}=n,M=d?{value:Array.isArray(t)?null:t,newDataLevel:!0,container:d,parent:d.parent}:{value:Array.isArray(t)?null:t,newDataLevel:!0,container:null,parent:i},N=this.createNodeFromRaw(_,s,A,u,M);if(!N)return;d?d.addNestedNode(N):i&&i.addChildNode(N);const S=new Map(a.alreadyConvertedValuesCache);S.set(t,N);let C;return this.isAsyncApiSimpleTreeNode(N)&&(C={parent:N,container:null,alreadyConvertedValuesCache:S}),this.isAsyncApiComplexTreeNode(N)&&(C={parent:i,container:N,alreadyConvertedValuesCache:S}),{value:t,state:C}}}createNodeFromRaw(s,t,o,n,a){const{parent:i,container:d,newDataLevel:_}=a;if(n){const N=this.createNodeMeta(t,a),S={type:O.COMPLEX,parent:i&&this.isAsyncApiSimpleTreeNode(i)?i:null,container:d&&this.isAsyncApiComplexTreeNode(d)?d:null,value:null,meta:N,newDataLevel:_};return this.tree.createComplexNode(s,t,o,!1,S)}const A=this.createNodeValue(t,o,{...a,parent:i,container:d}),u=this.createNodeMeta(t,a),M={type:O.SIMPLE,parent:i&&this.isAsyncApiSimpleTreeNode(i)?i:null,container:d&&this.isAsyncApiComplexTreeNode(d)?d:null,value:A,meta:u,newDataLevel:_};return this.tree.createSimpleNode(s,t,o,!1,M)}createNodeMeta(s,t){const{value:o,parent:n=null}=t;return{...this.isValueWithBrokenRef(o)?{brokenRef:`${o.$ref}`}:{},_fragment:o}}createNodeValue(s,t,o){const{value:n}=o;if(n==null||!p(n))return null;switch(t){case c.OPERATION:return this.pick(n,E.getAsyncApiTreeNodeValueProps(t));case c.BINDING:return this.pick(n,E.getAsyncApiTreeNodeValueProps(t));case c.JSO_PROPERTY:return this.pick(n,E.getAsyncApiTreeNodeValueProps(t));case c.CHANNEL:return this.pick(n,E.getAsyncApiTreeNodeValueProps(t));case c.MESSAGE:return this.pick(n,E.getAsyncApiTreeNodeValueProps(t));default:return null}}isAsyncApiNodeType(s){return!s||!Ue(s)?!1:Be.some(t=>t===s)}isAsyncApiSimpleTreeNode(s){return s.type===O.SIMPLE}isAsyncApiComplexTreeNode(s){return!this.isAsyncApiSimpleTreeNode(s)}isValueWithBrokenRef(s){return p(s)&&w in s}getNodeComplexityType(s){return O.SIMPLE}};l(E,"ASYNC_API_TREE_NODE_META_PROPS",[]),l(E,"ASYNC_API_TREE_NODE_VALUE_COMMON_PROPS",["title","description","summary"]);let I=E;const B=k.memo(r=>h.jsx(De,{fallback:h.jsx(Je,{componentName:"Async API Operation Viewer"}),children:h.jsx(qe,{...r})})),qe=k.memo(r=>{const{source:e,operationType:s,operationName:t,displayMode:o}=r,a=new I(e).build();return console.debug("[AsyncAPI] Tree:",a),h.jsx("div",{children:"Hello, Async API!"})});B.__docgenInfo={description:"",methods:[],displayName:"AsyncApiOperationViewer",props:{source:{required:!0,tsType:{name:"unknown"},description:""},operationType:{required:!1,tsType:{name:"string"},description:""},operationName:{required:!1,tsType:{name:"string"},description:""},displayMode:{required:!1,tsType:{name:"union",raw:`| typeof SIMPLE_DISPLAY_MODE
| typeof DETAILED_DISPLAY_MODE`,elements:[{name:"SIMPLE_DISPLAY_MODE"},{name:"DETAILED_DISPLAY_MODE"}]},description:""}}};const rt={title:"Async Api Viewer",component:B,parameters:{},argTypes:{source:{control:"object"}},args:{source:{}}},P={args:{source:{}}},Qe={asyncapi:"3.0.0",info:{title:"example-event-service",version:"1.0.0","x-generator":"springwolf"},defaultContentType:"application/json",servers:{"kafka-main":{host:"kafka-host",protocol:"kafka"}},channels:{"customer-change-topic":{address:"customer-change-topic",description:"Channel for customer change notifications",messages:{BaseEventMessage:{$ref:"#/components/messages/BaseEventMessage"}},servers:[{$ref:"#/servers/kafka-main"}],bindings:{}}},components:{schemas:{HeadersExample:{title:"HeadersExample",type:"object",properties:{"X-Idempotency-Key":{type:"string"}},examples:[{"X-Idempotency-Key":"string"}]},BaseEvent:{title:"BaseEvent",type:"object",properties:{currentInstance:{type:"object",description:"New data state"},currentModelVersion:{type:"integer",description:"Model Version",format:"int32"},previousInstance:{type:"object",description:"Previous data state"},resourceAction:{type:"string",description:"Resource Action"},resourceType:{type:"string",description:"Resource Type"}},description:"Base event to describe Customer's data changes",examples:[{currentInstance:{},currentModelVersion:0,previousInstance:{},resourceAction:"string",resourceType:"string"}],required:["currentInstance","currentModelVersion","previousInstance","resourceAction","resourceType"]}},messages:{BaseEventMessage:{headers:{$ref:"#/components/schemas/HeadersExample"},payload:{schemaFormat:"application/vnd.aai.asyncapi+json;version=3.0.0",schema:{$ref:"#/components/schemas/BaseEvent"}},name:"BaseEventMessage",title:"BaseEvent",bindings:{kafka:{bindingVersion:"0.5.0"}}}}},operations:{"customer-change-topic_send_BaseEvent":{action:"send",channel:{$ref:"#/channels/customer-change-topic"},title:"Customer change topic send",description:"Send events about Customer's data changes",bindings:{kafka:{bindingVersion:"0.5.0"}},messages:[{$ref:"#/channels/customer-change-topic/messages/BaseEventMessage"}]}}},R={args:{source:Ve({source:Qe})}};var H,L,D;P.parameters={...P.parameters,docs:{...(H=P.parameters)==null?void 0:H.docs,source:{originalSource:`{
  args: {
    source: {}
  }
}`,...(D=(L=P.parameters)==null?void 0:L.docs)==null?void 0:D.source}}};var J,V,b;R.parameters={...R.parameters,docs:{...(J=R.parameters)==null?void 0:J.docs,source:{originalSource:`{
  args: {
    source: prepareAsyncApiDocument({
      source: KAFKA_E2E_SOURCE
    })
  }
}`,...(b=(V=R.parameters)==null?void 0:V.docs)==null?void 0:b.source}}};const nt=["Test","KafkaE2E"];export{R as KafkaE2E,P as Test,nt as __namedExportsOrder,rt as default};
